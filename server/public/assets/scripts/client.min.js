var myApp=angular.module("myApp",["ngRoute"]);myApp.config(["$routeProvider",function(a){a.when("/home",{templateUrl:"/views/templates/home.html",controller:"LoginController"}).when("/register",{templateUrl:"/views/templates/register.html",controller:"LoginController"}).when("/user",{templateUrl:"/views/templates/user.html",controller:"UserController"}).when("/trips",{templateUrl:"/views/templates/trips.html",controller:"TripController",controllerAs:"trip"}).when("/packingList",{templateUrl:"/views/templates/packingList.html",controller:"PackingListController",controllerAs:"list"}).when("/invite",{templateUrl:"/views/templates/invite.html",controller:"InviteController",controllerAs:"invite"}).otherwise({redirectTo:"home"})}]),myApp.controller("InviteController",["MailService",function(a){var b=this;console.log("InviteController"),b.emailForm=a.emailInvite}]),myApp.controller("LoginController",["$scope","$http","$location",function(a,b,c){a.user={username:"",password:"",user_id:1},a.message="",a.login=function(){""==a.user.username||""==a.user.password?a.message="Enter your username and password":(console.log("sending to server...",a.user),b.post("/",a.user).then(function(b){b.data.username?(console.log("success: ",b.data),console.log("redirecting to user page"),c.path("/trips")):(console.log("failure: ",b),a.message="Wrong!!")}))},a.registerUser=function(){""==a.user.username||""==a.user.password?a.message="Choose a username and password":(console.log("sending to server...",a.user),b.post("/register",a.user).then(function(a){console.log("success"),c.path("/home")},function(b){console.log("error"),a.message="Please try again."}))}}]),myApp.controller("PackingListController",["PackingService",function(a){var b=this;console.log("packingListController"),b.postItem=a.postItem,console.log("newItem when controller loads: ",b.newItem),b.itemsObject=a.itemsObject,console.log(b.itemsObject),console.log("here lies user id: ",user.user_id),console.log("Here you go: ",a.selectedTrip),a.getItems(a.selectedTrip.id),console.log("clearItem?"),b.newItem={name:"",quantity:"",trip_id:a.selectedTrip.id}}]),myApp.controller("TripController",["MailService","PackingService","$location",function(a,b,c){var d=this;console.log("TripController"),b.getTrips(),d.createdTripObject=b.createdTripObject,d.invitedTripObject=b.invitedTripObject,d.joinedTripObject=b.joinedTripObject,d.log=b.log,d.postTrip=b.postTrip,d.deleteTrip=b.deleteTrip,d.joinTrip=b.joinTrip,d.inviteTrip=function(a){c.path("/invite")},d.printClickedTrip=function(a){b.selectedTrip.id=a,console.log("Boom, trip! ",b.selectedTrip),c.path("/packingList")}}]),myApp.controller("UserController",["$scope","$http","$location",function(a,b,c){console.log("checking user"),b.get("/user").then(function(b){b.data.username?(a.userName=b.data.username,console.log("User Data: ",a.userName)):c.path("/home")}),a.logout=function(){b.get("/user/logout").then(function(a){console.log("logged out"),c.path("/home")})}}]),myApp.factory("LoginService",["$http","$location",function(a,b){return{}}]),myApp.factory("MailService",["$http",function(a){function b(b){console.log(b),a.post("/userTrip",b).then(function(a){console.log("hit postUserTrip",b),console.log("userTrip success: ",a)})}return{hit:"Inside MailService",emailInvite:function(b){console.log("line 7",b),a.post("/mail",b).then(function(a){console.log("Email sent: ",a.data)})},assignTripId:b}}]),myApp.factory("PackingService",["$http","$location",function(a,b){function c(){a.get("/trips").then(function(a){l.createdTripArray=a.data}),a.get("/userTrip").then(function(a){j.invitedTripArray=a.data}),a.get("/userTrip/joined").then(function(a){k.joinedTripArray=a.data})}function d(d){a.post("/trips",d).then(function(a){console.log("success: ",a),c(),b.path("/packingList")})}function e(b){var c={tripId:b.trip_id,userId:b.user_id};a.put("/userTrip",c).then(function(a){})}function f(a){console.log("hit deleteTrip for:",a)}function g(b){console.log("hit getItems",b),a({method:"GET",url:"/items",params:{tripId:b}}).then(function(a){i.itemsArray=a.data,console.log("items array: ",i.itemsArray)})}function h(b){var c={name:b.name,quantity:b.quantity,trip_id:b.trip_id};console.log("inside factory: ",c),a.post("/items",c).then(function(a){}),g(c.trip_id)}var i={itemsArray:[]},j={invitedTripArray:[]},k={joinedTripArray:[]},l={createdTripArray:[]};return{log:"inside factory",postTrip:d,postItem:h,getTrips:c,createdTripObject:l,invitedTripObject:j,joinedTripObject:k,getItems:g,itemsObject:i,joinTrip:e,deleteTrip:f,selectedTrip:{id:""}}}]);